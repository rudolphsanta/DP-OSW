#20211121 Panel Figures
##Data
#Overall
ALL.Turbines <- c(15,10,8,5,3.45,2.5,3.3,3.4)
PowerRatioPT <- c(84.2,55.6,49.2,70.3,97.4,166.3,97.7,98.0)
PowerRatio14 <- c(95.6,66.5,63.2,85.6,123.4,198.8,123.6,119.4)
PowerRatio8 <- c(80.58,52.22,45.32,66.3,91.0,155.7,91.3,92.7)
A<-data.frame(ALL.Turbines,PowerRatioPT,PowerRatio8,PowerRatio14)

LCOE14 <- c(4241.95,445.36,445.93,1283.52,-747.27,-190.03,-734.44,-713.33)
LCOE8 <- c(562.66,170.67,137.84,295.55,1029.64,-203.50,1064.91,1109.49)

#Panels
#15MW. 3.8m Thruster
N.15_8 <- c(6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23)
PR.15_8 <- c(80.58,74.60,69.78,65.79,62.42,59.51,56.98,54.74,52.75,50.96,49.34,47.87,46.52,45.28,44.13,43.07,42.08,41.16)
LCOE.15_8 <- c(562.66,435.58,370.6,331.32,305.16,286.61,272.88,262.4,254.2,247.69,242.45,238.2,234.72,231.87,229.54,227.62,226.07,224.82)

N.15_14 <- c(6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30)
PR.15_14 <- c(95.61,88.52,82.80,78.07,74.06,70.61,67.61,64.96,62.59,60.47,58.55,56.80,55.20,53.73,52.37,51.11,49.93,48.83,47.81,46.84,45.93,45.07,44.26,43.49,42.76)
LCOE.15_14 <- c(4241.95,1638.37,1105.12,875.45,747.81,666.72,610.90,570.26,539.48,515.48,496.33,480.79,467.99,457.34,448.39,440.83,434.40,428.92,424.23,420.21,416.77,413.82,411.31,409.18,407.38)

N.15_PT <- c(6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30)
PR.15_PT <- c(84.20,77.95,72.92,68.75,65.22,62.19,59.54,57.20,55.12,53.25,51.56,50.02,48.61,47.32,46.12,45.01,43.97,43.01,42.10,41.25,40.45,39.69,38.98,38.30,37.66)

#10MW. 3.5m Thruster
N.10_8 <- c(4,5,6,7,8,9,10,11,12,13,14,15,16)
PR.10_8 <- c(52.22,46.71,42.64,39.48,36.93,34.82,33.03,31.49,30.15,28.97,27.92,26.97,26.11)
LCOE.10_8 <- c(170.67,155.61,146.83,141.29,137.63,135.34,133.66,132.55,132.03,131.66,131.53,131.76,131.98)

N.10_14 <- c(4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20)
PR.10_14 <- c(66.50,59.48,54.29,50.27,47.02,44.33,42.06,40.10,38.39,36.89,35.54,34.34,33.25,32.26,31.35,30.51,29.74)
LCOE.10_14 <- c(445.36,373.31,335.51,312.50,297.25,286.61,278.92,273.26,269.05,265.90,263.57,261.88,260.70,259.93,259.51,259.36,259.45)

N.10_PT <- c(4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20)
PR.10_PT <- c(55.62,49.75,45.41,42.04,39.33,37.08,35.18,33.54,32.11,30.85,29.73,28.72,27.81,26.98,26.22,25.52,24.87)

#8MW. 4.1m Thruster
N.8_8 <- c(2,3,4,5,6,7,8,9,10,11,12,13,14)
PR.8_8 <- c(45.32,37.01,32.05,28.67,26.17,24.23,22.66,21.37,20.27,19.33,18.50,17.78,17.13)
LCOE.8_8 <-c(137.84,123.25,117.48,114.98,114.05,114.02,114.72,115.62,116.78,118.13,119.79,121.4,123.09)

N.8_14 <- c(2,3,4,5,6,7,8,9,10,11,12,13,14)
PR.8_14 <- c(63.23,51.62,44.71,39.99,36.50,33.80,31.61,29.81,28.28,26.96,25.81,24.80,23.90)
LCOE.8_14 <- c(445.93,347.44,311.39,293.72,284.05,278.62,275.71,274.45,274.30,274.97,276.27,277.99,280.08)

N.8_PT <- c(2,3,4,5,6,7,8,9,10,11,12,13,14)
PR.8_PT <- c(49.19,40.16,34.78,31.11,28.40,26.29,24.59,23.19,22.00,20.97,20.08,19.29,18.59)

#5MW. 3.8m Thruster
N.5_8 <- c(2,3,4,5,6,7,8,9,10,11,12,13,14)
PR.5_8 <- c(66.27,54.11,46.86,41.91,38.26,35.42,33.13,31.24,29.64,28.26,27.05,25.99,25.05)
LCOE.5_8 <- c(295.55,225.31,201.55,190.76,185.48,183.07,182.34,182.71,183.81,185.44,187.46,189.01,192.33)

N.5_14 <- c(2,3,4,5,6,7,8,9,10,11,12,13,14)
PR.5_14 <- c(85.56,69.86,60.50,54.11,49.40,45.73,42.78,40.33,38.26,36.48,34.93,33.56,32.34)
LCOE.5_14 <- c(1283.52,634.33,498.86,442.19,412.57,395.51,385.33,379.35,376.12,374.73,374.79,375.88,377.76)

N.5_PT <- c(2,3,4,5,6,7,8,9,10,11,12,13,14)
PR.5_PT <- c(70.29,57.39,49.70,44.45,40.58,37.57,35.14,33.13,31.43,29.97,28.70,27.57,26.57)

#2.5MW. 4.1m Thruster
N.2.5_8 <- c(1,2,3,4,5,6,7,8,9,10,11,12,13)
PR.2.5_8 <- c(155.70,110.10,89.89,77.85,69.63,63.56,58.85,55.05,51.90,49.24,46.95,44.95,43.18)
LCOE.2.5_8 <- c(NA,NA,1328.26,652.00,509.07,452.25,425.17,413.29,407.41,406.10,407.75,412.60,417.72)

N.2.5_14 <- c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16)
PR.2.5_14 <- c(198.81,140.58,114.78,99.40,88.91,81.16,75.14,70.29,66.27,62.87,59.94,57.39,55.14,53.13,51.33,49.70)
LCOE.2.5_14 <- c(NA,NA,NA,38843.60,2218.56,1383.53,1107.04,975.24,902.21,858.82,832.46,817.00,808.48,804.96,805.10,807.97)

N.2.5_PT <- c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16)
PR.2.5_PT <- c(166.29,117.59,96.01,83.15,74.37,67.89,62.85,58.79,55.43,52.59,50.14,48.00,46.12,44.44,42.94,41.57)

#3.45MW. 3.2 Thruster
N.3.45_8 <- c(2,3,4,5,6,7,8,9,10,11,12,13,14)
PR.3.45_8 <- c(91.01,74.31,64.35,57.56,52.54,48.65,45.50,42.90,40.70,38.81,37.15,35.70,34.40)
LCOE.3.45_8 <- c(1029.64,376.58,282.04,246.71,228.62,219.38,213.68,211.24,209.79,210.1,210.61,212.31,213.88)

N.3.45_14 <- c(2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20)
PR.3.45_14 <- c(123.35,100.72,87.22,78.02,71.22,65.94,61.68,58.15,55.17,52.60,50.36,48.38,46.62,45.04,43.61,42.31,41.12,40.02,39.01)
LCOE.3.45_14 <- c(NA,NA,1466.06,881.03,695.37,606.28,555.58,524.02,503.40,489.61,480.40,474.39,470.72,468.81,468.25,468.86,470.22,472.28,474.90)

N.3.45_PT <- c(2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20)
PR.3.45_PT <- c(97.39,79.52,68.87,61.60,56.23,52.06,48.70,45.91,43.56,41.53,39.76,38.20,36.81,35.56,34.43,33.41,32.46,31.60,30.80)

#3.3MW. 3.2m Thruster
N.3.3_8 <- c(2,3,4,5,6,7,8,9,10,11,12,13,14)
PR.3.3_8 <- c(91.30,74.54,64.56,57.74,52.71,48.80,45.65,43.04,40.83,38.93,37.27,35.81,34.51)
LCOE.3.3_8 <- c(1064.91,381.19,284.93,249.26,231.09,221.93,216.33,214.04,212.72,213.22,213.88,215.78,217.51)

N.3.3_14 <- c(2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20)
PR.3.3_14 <- c(123.65,100.96,87.43,78.20,71.39,66.09,61.82,58.29,55.30,52.72,50.48,48.50,46.73,45.15,43.72,42.41,41.22,40.12,39.10)
LCOE.3.3_14 <- c(NA,NA,1487.18,887.86,699.81,610.06,559.21,527.69,507.20,493.61,484.62,478.85,475.43,473.77,473.47,474.36,475.99,478.31,481.22)

N.3.3_PT <- c(2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20)
PR.3.3_PT <- c(97.67,79.75,69.07,61.77,56.39,52.21,48.84,46.04,43.68,41.65,39.88,38.31,36.92,35.67,34.53,33.50,32.56,31.69,30.89)

#3.4MW. 3.2m Thruster
N.3.4_8 <- c(2,3,4,5,6,7,8,9,10,11,12,13,14)
PR.3.4_8 <- c(92.67,75.66,65.52,58.61,53.50,49.53,46.33,43.68,41.44,39.51,37.83,36.35,35.02)
LCOE.3.4_8 <- c(1109.49,349.59,256.59,222.68,205.48,196.67,191.24,188.83,187.36,187.52,187.88,189.33,190.67)

N.3.4_14 <- c(2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17)
PR.3.4_14 <- c(119.44,97.52,84.45,75.54,68.96,63.84,59.72,56.30,53.41,50.93,48.76,46.85,45.14,43.61,42.23,40.97)
LCOE.3.4_14 <- c(NA,5797.21,958.07,629.90,513.08,454.73,420.96,399.83,386.08,377.01,371.10,367.42,365.39,364.60,364.76,365.77)

N.3.4_PT <- c(2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17)
PR.3.4_PT <- c(97.99,80.01,69.29,61.98,56.58,52.38,49.00,46.19,43.82,41.78,40.01,38.44,37.04,35.78,34.65,33.61)

## Figure
#Power Ratio
par(mar=c(4.5,6,4,4))
plot(x = ALL.Turbines, y = PowerRatio14, pch = 19, col = 'red', cex = 1.5,
     ylab = 'Power Ratio [%]', xlab = 'Turbine Size [MW]', las = 1, cex.lab = 1.6,
     cex.axis = 1.6, xaxs = 'i', yaxs = 'i', ylim = c(0,200), xlim = c(2,16))
points(x = ALL.Turbines, y = PowerRatioPT, pch = 15, col = 'blue', cex = 1.5)
points(x = ALL.Turbines, y = PowerRatio8, pch = 17, col = 'black', cex = 1.5)
abline(h = 100)
legend("topright",legend = c("Portuguese Wind Profile","Wind Speed Class 8", "Wind Speed Class 14"),
       col = c("blue","black","red"), pch = c(15,17,19))

#Power Ratio Panels
layout(matrix(1:8, ncol=4, byrow=TRUE))
par(oma=c(4, 4, 4, 4), mar=c(1.75,1.75,1.75,1.75))

plot(N.2.5_8,PR.2.5_8,pch=17,las=1,xaxs='i',yaxs='i',ylim=c(0,150),xlim=c(1,15),main="2.5 MW",cex=1.4)
points(N.2.5_14, PR.2.5_14, pch = 19, col = 'red', cex = 1.3)
points(N.2.5_PT, PR.2.5_PT, pch = 15, col = 'blue', cex = 1.1)
abline(h = 100)

plot(N.3.3_8,PR.3.3_8,pch=17,las=1,xaxs='i',yaxs='i',ylim=c(0,150),xlim=c(1,15),main="3.3 MW",cex=1.4)
points(N.3.3_14, PR.3.3_14, pch = 19, col = 'red', cex = 1.3)
points(N.3.3_PT, PR.3.3_PT, pch = 15, col = 'blue', cex = 1.1)
abline(h = 100)

plot(N.3.4_8,PR.3.4_8,pch=17,las=1,xaxs='i',yaxs='i',ylim=c(0,150),xlim=c(1,15),main="3.4 MW",cex=1.4)
points(N.3.4_14, PR.3.4_14, pch = 19, col = 'red', cex = 1.3)
points(N.3.4_PT, PR.3.4_PT, pch = 15, col = 'blue', cex = 1.1)
abline(h = 100)

plot(N.3.45_8,PR.3.45_8,pch=17,las=1,xaxs='i',yaxs='i',ylim=c(0,150),xlim=c(1,15),main="3.45 MW",cex=1.4)
points(N.3.45_14, PR.3.45_14, pch = 19, col = 'red', cex = 1.3)
points(N.3.45_PT, PR.3.45_PT, pch = 15, col = 'blue', cex = 1.1)
abline(h = 100)

plot(N.5_8,PR.5_8,pch=17,las=1,xaxs='i',yaxs='i',ylim=c(0,150),xlim=c(1,15),main="5 MW",cex=1.4)
points(N.5_14, PR.5_14, pch = 19, col = 'red', cex = 1.3)
points(N.5_PT, PR.5_PT, pch = 15, col = 'blue', cex = 1.1)
abline(h = 100)

plot(N.8_8,PR.8_8,pch=17,las=1,xaxs='i',yaxs='i',ylim=c(0,150),xlim=c(1,15),main="8 MW",cex=1.4)
points(N.8_14, PR.8_14, pch = 19, col = 'red', cex = 1.3)
points(N.8_PT, PR.8_PT, pch = 15, col = 'blue', cex = 1.1)
abline(h = 100)

plot(N.10_8,PR.10_8,pch=17,las=1,xaxs='i',yaxs='i',ylim=c(0,150),xlim=c(1,18),main="10 MW",cex=1.4)
points(N.10_14, PR.10_14, pch = 19, col = 'red', cex = 1.3)
points(N.10_PT, PR.10_PT, pch = 15, col = 'blue', cex = 1.1)
abline(h = 100)

plot(N.15_8,PR.15_8,pch=17,las=1,xaxs='i',yaxs='i',ylim=c(0,150),xlim=c(1,25),main="15 MW",cex=1.4)
points(N.15_14, PR.15_14, pch = 19, col = 'red', cex = 1.3)
points(N.15_PT, PR.15_PT, pch = 15, col = 'blue', cex = 1.1)
abline(h = 100)

mtext("Number of Thrusters", side = 1, line = 1, cex = 1.5, col = "black", outer = TRUE)
mtext("Power Ratio [%]", side = 2, line = 1, cex = 1.5, col = "black", outer = TRUE)

#LCOE
par(mar=c(4.5,6,4,4))
plot(x = ALL.Turbines, y = LCOE14, pch = 19, col = 'red', cex = 1.5,
     ylab = '', xlab = 'Turbine Size [MW]', las = 1, cex.lab = 1.6,
     cex.axis = 1.6, xaxs = 'i', yaxs = 'i', ylim = c(0,5000),xlim = c(2,16))
points(x = ALL.Turbines, y = LCOE8, pch = 17, col = 'black', cex = 1.5)
mtext("LCOE[$/MWh]", side = 2, line = 4,cex = 1.6)
legend("topleft",legend = c("Wind Speed Class 8", "Wind Speed Class 14"),
       col = c("black","red"), pch = c(17,19))
#LCOE
min.lcoe8 <- 66
max.lcoe8 <- 78
min.lcoe14 <- 138
max.lcoe14 <- 153
layout(matrix(1:8, ncol=4, byrow=TRUE))
par(oma=c(4, 4, 4, 4), mar=c(1.75,1.75,1.75,1.75))


plot(N.2.5_8,LCOE.2.5_8,pch=17,las=1,xaxs='i',ylim=c(0,2000),xlim=c(1,15),yaxs='i',main="2.5 MW",cex=1.4)
polygon(c(0,25,25,0),c(min.lcoe8,min.lcoe8,max.lcoe8,max.lcoe8),col='black',lty=0)
polygon(c(0,25,25,0),c(min.lcoe14,min.lcoe14,max.lcoe14,max.lcoe14),col='red',lty=0)
points(N.2.5_14, LCOE.2.5_14, pch = 19, col = 'red', cex = 1.3)

plot(N.3.3_8,LCOE.3.3_8,pch=17,las=1,xaxs='i',ylim=c(0,2000),xlim=c(1,15),yaxs='i',main="3.3 MW",cex=1.4)
polygon(c(0,25,25,0),c(min.lcoe8,min.lcoe8,max.lcoe8,max.lcoe8),col='black',lty=0)
polygon(c(0,25,25,0),c(min.lcoe14,min.lcoe14,max.lcoe14,max.lcoe14),col='red',lty=0)
points(N.3.3_14, LCOE.3.3_14, pch = 19, col = 'red', cex = 1.3)

plot(N.3.4_8,LCOE.3.4_8,pch=17,las=1,xaxs='i',ylim=c(0,2000),xlim=c(1,15),yaxs='i',main="3.4 MW",cex=1.4)
polygon(c(0,25,25,0),c(min.lcoe8,min.lcoe8,max.lcoe8,max.lcoe8),col='black',lty=0)
polygon(c(0,25,25,0),c(min.lcoe14,min.lcoe14,max.lcoe14,max.lcoe14),col='red',lty=0)
points(N.3.4_14, LCOE.3.4_14, pch = 19, col = 'red', cex = 1.3)

plot(N.3.45_8,LCOE.3.45_8,pch=17,las=1,xaxs='i',ylim=c(0,2000),xlim=c(1,15),yaxs='i',main="3.45 MW",cex=1.4)
polygon(c(0,25,25,0),c(min.lcoe8,min.lcoe8,max.lcoe8,max.lcoe8),col='black',lty=0)
polygon(c(0,25,25,0),c(min.lcoe14,min.lcoe14,max.lcoe14,max.lcoe14),col='red',lty=0)
points(N.3.45_14, LCOE.3.45_14, pch = 19, col = 'red', cex = 1.3)

plot(N.5_8,LCOE.5_8,pch=17,las=1,xaxs='i',ylim=c(0,1000),xlim=c(1,15),yaxs='i',main="5 MW",cex=1.4)
polygon(c(0,25,25,0),c(min.lcoe8,min.lcoe8,max.lcoe8,max.lcoe8),col='black',lty=0)
polygon(c(0,25,25,0),c(min.lcoe14,min.lcoe14,max.lcoe14,max.lcoe14),col='red',lty=0)
points(N.5_14, LCOE.5_14, pch = 19, col = 'red', cex = 1.3)

plot(N.8_8,LCOE.8_8,pch=17,las=1,xaxs='i',ylim=c(0,1000),xlim=c(1,15),yaxs='i',main="8 MW",cex=1.4)
polygon(c(0,25,25,0),c(min.lcoe8,min.lcoe8,max.lcoe8,max.lcoe8),col='black',lty=0)
polygon(c(0,25,25,0),c(min.lcoe14,min.lcoe14,max.lcoe14,max.lcoe14),col='red',lty=0)
points(N.8,LCOE.8,pch=17,cex=1.4)
points(N.8_14, LCOE.8_14, pch = 19, col = 'red', cex = 1.3)

plot(N.10_8,LCOE.10_8,pch=17,las=1,xaxs='i',ylim=c(0,1000),xlim=c(1,18),yaxs='i',main="10 MW",cex=1.4)
polygon(c(0,25,25,0),c(min.lcoe8,min.lcoe8,max.lcoe8,max.lcoe8),col='black',lty=0)
polygon(c(0,25,25,0),c(min.lcoe14,min.lcoe14,max.lcoe14,max.lcoe14),col='red',lty=0)
points(N.10,LCOE.10,pch=17,cex=1.4)
points(N.10_14, LCOE.10_14, pch = 19, col = 'red', cex = 1.3)

plot(N.15_8,LCOE.15_8,pch=17,las=1,xaxs='i',ylim=c(0,1000),xlim=c(1,25),yaxs='i',main="15 MW",cex=1.4)
polygon(c(0,25,25,0),c(min.lcoe8,min.lcoe8,max.lcoe8,max.lcoe8),col='black',lty=0)
polygon(c(0,25,25,0),c(min.lcoe14,min.lcoe14,max.lcoe14,max.lcoe14),col='red',lty=0)
points(N.15_14, LCOE.15_14, pch = 19, col = 'red', cex = 1.3)

mtext("Number of Thrusters", side = 1, line = 1, cex = 1.5, col = "black", outer = TRUE)
mtext("LCOE[$/MWh]", side = 2, line = 1.5, cex = 1.5, col = "black", outer = TRUE)

